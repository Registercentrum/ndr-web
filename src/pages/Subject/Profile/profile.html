

<div class="row">
  <div class="col-md-12">
    <h2 class="Page-title mt0">Min Diabetesprofil</h2>
    <h4>{{subject.socialNumber}}</h4>
  </div>
</div>

<div class="row">
  <div class="col-md-12">

    <tabset justified class="nav-tabs-secondary nav-tabs-negative-15">

      <tab heading="{{ tabOversight.heading }}" active="tabOversight.active">

        <div class="row mt4">

          <div class="col-md-4">
            <div class="P">
              <div class="title">
                <h1>Grunddata</h1>
              </div>
              <div class="body">
                <p class="mb0">{{ subject.diabetesTypeText }} sedan {{ subject.yearOfOnset }}</p>
                <p>
                  Behandling: {{ model.latest.treatment.label }}</p>
                </p>
                <p ng-show="model.latest.insulinMethod.value == 2">
                  Metod att ge insulin: {{ model.latest.insulinMethod.label }}
                </p>
                <p ng-show="model.latest.insulinMethod.label == 'Insulinpump'">
                  Pågående pumpmodell: {{ model.latest.pumpOngoing.label }}
                </p>
                <p ng-show="model.latest.cgm.value">
                  CGM/FGM: {{ model.latest.cgm.label + ((model.latest.cgmType.value && model.latest.cgm.value) ? ', ' + model.latest.cgmType.label : '') }}
                </p>
              </div>
            </div> <!-- End of grunddata-->
          </div> <!-- End of column-->


          <div class="col-md-4">
            <div class="P">
              <div class="title">
                <h1>Fysisk aktivitet</h1>
              </div>
              <div class="body">
                <div class="PhysicalChart" physical-chart model="model.latest.physicalActivity">
                  <div style="padding-top:10px;clear:both"></div>
                  <div
                          ng-repeat="item in model.latest.physicalActivity.domainValues"
                          ng-style="{'font-weight' : model.latest.physicalActivity.value == item.code ? 'bold' : 'normal' }"
                          style="text-align:center;width: 20%;float:left"
                          ng-class="{'active' : model.latest.physicalActivity.value == item.code }">
                    <div style="height:35px;border:2px solid #fff;" ng-style="{'background-color' : model.latest.physicalActivity.value == item.code ? '#74bad8' : '#ccc' }"></div>
                    <span style="font-size: 12px">{{ item.text}}</span>
                  </div>
                  <div style="text-align: center">(gånger per vecka)</div>
                </div>
              </div>
            </div> <!-- End of grunddata-->
          </div> <!-- End of column-->


          <div class="col-md-4">
            <div class="P">
              <div class="title">
                <h1>Rökning</h1>
              </div>
              <div class="body">
                <h3 class="text-center" style="margin-top: 10px">{{ model.latest.smokingHabit.label }}</h3>

              </div>
            </div> <!-- End of grunddata-->
          </div> <!-- End of column-->


        </div> <!-- End of row-->


        <div class="row mt4">

          <div class="col-md-4">
            <div class="P">
              <div class="title">
                <h1>Fötter</h1>
              </div>
              <div class="body">
                <table class="table table-condensed">
                  <tr>
                    <td>Riskkategori</td>
                    <td>{{ model.latest.footRiscCategory.label }}</td>
                  </tr>
                  <tr>
                    <td>Senaste fotundersökning</td>
                    <td>{{ model.latest.footExaminationDate.label }}</td>
                    <td>
                      <div ng-show="checkFootDate(model.latest.footExaminationDate)">
                        <i tooltip="OBS: Senaste rapporterade fotundersökning har ett datum mer än 1 år tillbaka i tiden." class="fa fa-exclamation"></i>
                      </div>
                    </td>
                  </tr>
                </table>
              </div>
            </div> <!-- End of grunddata-->
          </div> <!-- End of column-->


          <div class="col-md-4">
            <div class="P">
              <div class="title">
                <h1>Ögon</h1>
              </div>
              <div class="body">
                <table class="table table-condensed">
                  <tr>
                    <td width="80">Diabetesretinopati</td>
                    <td width="20" style="width:50%">{{ model.latest.diabeticRetinopathy.label }}</td>
                  </tr>
                  <tr>
                    <td width="80">Diagnos på sämsta ögat</td>
                    <td width="20">{{ model.latest.diabeticRetinopathy.value != 0 ? model.latest.diagnosisWorseSeeingEye.label : null  }}</td>
                  </tr>
                  <tr>
                    <td width="80">Laserbehandlad</td>
                    <td width="20">{{ model.latest.laserTreatment.label}}</td>
                  </tr>
                  <tr>
                    <td width="80">Senaste ögonbottenundersökning</td>
                    <td width="20">{{  model.latest.fundusExaminationDate.label }}</td>
                  </tr>
                  <tr>
                    <td width="80">Synnedsättning p.g.a. diabetes</td>
                    <td width="20">{{ model.latest.visualLoss.label  }}</td>
                  </tr>
                </table>

              </div>
            </div> <!-- End of grunddata-->
          </div> <!-- End of column-->


          <div class="col-md-4">
            <div class="P">
              <div class="title">
                <h1>Njurar</h1>
              </div>
              <div class="body">
                <table class="table table-condensed">
                  <tr>
                    <td>Senaste S-Kreatininvärde</td>
                    <td>{{ model.latest.creatinine.label }}</td>
                  </tr>
                  <tr>
                    <td>Makroalbuminuri</td>
                    <td>{{ model.latest.macroscopicProteinuria.label }}</td>
                  </tr>
                  <tr ng-hide="model.latest.macroscopicProteinuria.label == 'Ja'">
                    <td>Mikroalbuminuri</td><td>{{ model.latest.microscopicProteinuria.label }}</td>
                  </tr>
                </table>
              </div>
            </div> <!-- End of grunddata-->
          </div> <!-- End of column-->


        </div> <!-- End of row-->


        <div class="row mt4">

          <div class="col-md-12">

            <div class="P">
              <div class="title">
                <h1>Utveckling över tid</h1>
              </div>
              <div class="body">

                <div class="row pv4" ng-repeat="chart in subject.charts">
                  <h4 class="col-md-12">{{ chart.title }}</h4>
                  <div class="col-md-9">
                    <div
                            line-chart
                            model="chart.series"
                            y-max="{{ chart.yMax }}"
                            y-min="0"
                            date-format="%Y-%m-%d"
                            height="200"
                            color="#5EBCDC"
                    ></div>
                  </div>
                  <div class="col-md-3">
                    Senaste {{ chart.title }}<br />
                    <span class="f1 b">{{ chart.latest }}</span>
                  </div>
                </div>


              </div>
            </div> <!-- End of charts-->

          </div> <!-- End of column-->

        </div> <!-- End of row-->






      </tab>

      <tab heading="{{ tabAnsweredSourveys.heading }}" active="tabAnsweredSourveys.active">


        <div class="row mt4">

          <div class="col-md-12">

            <div class="P">
              <div class="title">
                <h1>Senaste enkäten ({{ model.latestInvite.submittedAt | date:'yyyy-MM-dd'  }})</h1>
              </div>

              <div class="body">
                <div ng-if="model.selectedInviteData.length > 0" bar-chart categories="model.categories" model="model.selectedInviteData"></div>
              </div>

            </div>


            <div class="P">
              <div class="title">
                <h1>Utveckling över tid</h1>
              </div>

              <div class="body">
                <div line-chart-prom-combined model="model.promSeries"></div>
              </div>
            </div>

          </div>

        </div>


        <!--<div ng-repeat="group in PROMFormMeta" class="row">
          <h3 class="col-md-12 pv5">{{ group.groupID }}. {{ group.description }}</h3>
          <div ng-repeat="survey in subject.surveys[group.groupID]" class="pv4">
            <h4 class="col-md-12">{{ survey.dimension.desc }}</h4>
            <div class="col-md-9">
              <div
                line-chart
                model="survey.series"
                y-min="0"
                y-max="100"
                height="200"
                color="#4A99C5"
              ></div>
            </div>
            <div class="col-md-3">
              Senaste värdet<br />
              <span class="f1 b">{{ survey.latestOutcome }}</span>
              <sup
                ng-show="survey.diffFromPrevious !== null"
                ng-class="{red: survey.diffFromPrevious < 0}"
              >{{ survey.diffFromPrevious }}</sup>
            </div>
          </div>
        </div>-->
      </tab>
    </tabset>
  </div>
</div>