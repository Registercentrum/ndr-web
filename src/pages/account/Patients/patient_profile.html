<div class="row">
    <div class="col-md-5">
        <h1 class="Page-title">Patientprofil</h1>
    </div>
    <form class="col-md-7 text-right" role="search" name="subjectForm" novalidate>
        <div class="PatientSearch">
            <div class="PatientSearch-inner">
        <span class="PatientSearch-icon">
          <img src="/images/svgmin/icon_search.svg" class="PatientSearch-icon-img">
        </span>
                <input class="PatientSearch-input" ng-model="socialnumber" type="search" placeholder="Skriv in personnummer" required ng-pattern="accountHelpers.pnrRegex">
                <button style="border-left: 1px solid white;" ng-click="getSubject(true)" class="PatientSearch-reportButton">Visa profil</button>
            </div>
        </div>
    </form>
</div>

<div id="patient" ng-show="subject">


<div class="row">

    <div class="col-md-12">

        <div class="PatientHeader clearfix">
            <div class="PatientHeader-personNumber col-md-5 u-noLeftPadding">
                <i class="fa fa-user"></i>  {{ subject.socialNumber }}
            </div>
            <div class="PatientHeader-navigation col-md-7 u-noRightPadding">

                <div class="row">
                    <div class="col-md-12 text-right" style="margin-top: 10px;">
                        <a class="Button--tight Button Button--dark" ng-click=""><i class="fa fa-print"></i> Skriv ut</a>
                        <a style="margin-right: 20px" href="#/inloggad/patient/{{ subject.subjectID }}" class="Button--tight Button Button--dark" ng-click=""><i class="fa fa-plus-circle"></i> Nytt besök</a>

                        <div class="btn-group" style="float:right">
                            <label class="btn Button--tight  Button Button--dark" ng-model="model.mode" btn-radio="'visual'"><i class="fa fa-area-chart"></i> Profil</label>
                            <label class="btn Button--tight Button Button--dark" ng-model="model.mode" btn-radio="'table'"><i class="fa fa-table"></i> Tabell </label>
                        </div>
                    </div>
                </div>

            </div>
        </div>


    </div>
</div>


<div ng-show="model.mode == 'visual'" class="Profile">

    <div class="row" id="printableArea">
        <div class="col-md-12">

            <div class="Panel Panel--blue clearfix" style="padding: 0px">

                <div class="Panel--profile col-md-4">

                    <b>{{ subject.socialNumber }}</b>
                    <br>
                    {{ "Man, " + calculateAge(subject.dateOfBirth) }} år gammal
                    <br/>
                    Typ: {{ getDiabetesType(subject.diabetesType) }}
                    <br/>
                    Debutår: {{ subject.yearOfOnset }}
                    <br/>
                    Diabetesbehandling: {{ model.latest.treatment.label }}

                </div>

                <div class="Panel--profile col-md-4 text-center">

                    <div class="text-center" tooltip="{{ model.latest.bmi.date | date: 'shortDate' }}">
                        <h3>{{ model.latest.bmi.value }}</h3>
                        <h4>BMI
                        </h4>
                    </div>

                    <div class="text-center">
                        <h3 title="Dag av besöket {{ model.latest.weight.date | date: 'dd MM yyyy' }}">{{ model.latest.weight.value }} kg</h3>
                        <h4>Vikt</h4>
                    </div>



                </div>

                <div class="Panel--profile Panel--profile-last col-md-4">
                    <h4 class="Profile-heading">HbA1c</h4> <h4 class="Profile-latest-value">{{ model.latest.hba1c.value }} <span class="unit">mmol/mol</span></h4>
                    <div class="" line-chart-patient-hba1c model="model.data.trend.hba1c"></div>

                </div>

            </div>
        </div>
    </div>

    <div class="row">


        <div class="col-md-6">

            <div class="Panel Panel--purple">
                <h4>Kolesterol</h4>

                <div class="col-sm-4" line-chart-patient-hba1c model="model.data.trend.cholesterol"></div>
                <div class="col-sm-4" line-chart-patient-hba1c model="model.data.trend.ldl"></div>
                <div class="col-sm-4" line-chart-patient-hba1c model="model.data.trend.hdl"></div>

                <div> Behandlas med lipidsänkande läkemedel: {{ model.latest.lipidLoweringDrugs.label }}</div>

            </div>
        </div>

        <div class="col-md-6">

            <div class="Panel Panel--green">
                <h4 class="Profile-heading">Blodtryck</h4><h4 class="Profile-latest-value">{{model.latest.bpSystolic.value + "/" + model.latest.bpDiastolic.value }} <span class="unit">mm Hg</span></h4>
                <div class="" line-chart-patient-hba1c model="model.data.trend.bpSystolic"></div>
                <div>Behandlas med blodtryckssänkande läkemedel: {{ model.latest.antihypertensives.label }}</div>

            </div>
        </div>

    </div>

    <div class="row">

        <div class="col-md-4">

            <div class="Panel Panel--green">
                <h4 class="Profile-heading">Hjärt-/kärlsjukdom</h4><i class="Profile-latest-value icon icon-noun_4451_cc" class="pull-right" style="font-size: 40px;"></i>

                <table class="table">
                    <tr><td tooltip="(någonsin, angina pectoris, genomgången hjärtinfarkt, PTCA, by-passkirurgi)">Ischemisk hjärtsjukdom
                    </td><td>{{ model.latest.ischemicHeartDisease.label }}</td></tr>
                    <tr><td>Cerebrovaskulär sjukdom</td><td>{{ model.latest.cerebrovascularDisease.label }}</td></tr>
                    <tr><td>Behandlas med ASA</td><td>{{ model.latest.aspirin.label }}</td></tr>
                    <tr><td>Waran</td><td>{{ model.latest.waran.label }}</td></tr>
                </table>

            </div>
        </div>

        <div class="col-md-4">

            <div class="Panel">
                <h4 class="Profile-heading">Fysisk aktivitet</h4><i class="Profile-latest-value icon icon-noun_79" class="pull-right" style="font-size: 30px;"></i>

                <!--<div gauge-chart model="model.data.chart.physicalActivity"></div>-->

            </div>
        </div>

        <div class="col-md-4">

            <div class="Panel Panel--purple">
                <h4 class="Profile-heading">Rökning</h4><i class="Profile-latest-value icon icon-noun_79" class="pull-right" style="font-size: 30px;"></i>
                    <div>

                        {{ model.latest.smokingHabit.label }}

                    </div>
            </div>
        </div>



    </div>

    <div class="row">

        <div class="col-md-4">
            <div class="Panel">
                <h4><img src="images/grunticon/png/icon_foot.png" style="width:15px;margin-right: 10px" alt=""/>Fötter</h4>
                <table class="table table-condensed table-striped">
                    <tr><td>Riskkategori</td><td>{{ model.latest.footRiscCategory.label }}</td></tr>
                    <tr><td>Senaste fotundersökning </td><td>{{ model.latest.footExaminationDate.label }}</td><td><i class="fa fa-exclamation"></i>
                    </td></tr>
                </table>


            </div>
        </div>

        <div class="col-md-4">

            <div class="Panel">
                <h4><img src="images/grunticon/png/icon_eye.png" style="width:25px;margin-right: 10px" alt=""/>Ögon</h4>
                <table class="table table-condensed table-striped">
                    <tr><td>Diabetesretinopati</td><td>{{ model.latest.diabeticRetinopathy.label }}</td></tr>
                    <tr><td>Diagnos på sämsta ögat</td><td>{{ model.latest.diagnosisWorseSeeingEye.label  }}</td></tr>
                    <tr><td>Laserbehandlad</td><td>{{ model.latest.laserTreatment.label}}</td></tr>
                    <tr><td>Senaste ögonbottenundersökning</td><td>{{  model.latest.fundusExaminationDate.label }}</td></tr>
                    <tr><td>Synnedsättning p.g.a. diabetes</td><td>{{ model.latest.visualLoss.label  }}</td></tr>
                </table>
            </div>
        </div>


        <div class="col-md-4">

            <div class="Panel">
                <h4><img src="images/grunticon/png/icon_kidney.png" style="width:20px;margin-right: 10px" alt=""/> Njurar</h4>

                <table class="table table-condensed table-striped">
                    <tr><td>Senaste S-Kreatininvärde</td><td>{{ model.latest.serumCreatinine.label }}</td></tr>
                    <tr><td>Makroalbuminuri</td><td>{{ model.latest.macroscopicProteinuria.label }}</td></tr>
                    <tr ng-hide="model.latest.macroscopicProteinuria.label == 'Ja'"><td>Mikroalbuminuri</td><td>{{ model.latest.microscopicProteinuria.label }}</td></tr>
                </table>

            </div>
        </div>



    </div>


</div>


<div ng-show="model.mode == 'table'" class="Panel">
    <h2>Besök</h2>
    <div class="table-responsive">
        <table style="font-size: 13px" class="Table--fixed table table-striped table-bordered row-border hover visits-table">
            <thead>
                <tr>
                    <th class="key"></th>
                    <th ng-repeat="date in model.data.table['Besöksdatum']">{{ date | date : 'dd MMM yyyy'}}</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="(key, contact) in model.data.table">
                    <td class="key">{{ key }}</td>
                    <td ng-repeat="c in contact track by $index">{{ c }}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

</div>
<script type="text/javascript">
    jQuery('.u-equalHeight').matchHeight(true);
</script>

<!--

<div class="Panel">
    <h2>Model</h2>
&lt;!&ndash;     <pre>
        {{ model.latest | json }}
    </pre>&ndash;&gt;

</div>

-->
